<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF & URL Chat Assistant</title>
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f9fafb;
            color: #111827;
            line-height: 1.5;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        h1 {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2rem;
            color: #111827;
        }

        h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: #111827;
        }

        /* Upload area */
        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 0.5rem;
            padding: 3rem 1rem;
            text-align: center;
            cursor: pointer;
            margin-bottom: 2rem;
            transition: background-color 0.2s;
        }

        .upload-area:hover {
            background-color: #f3f4f6;
        }

        .upload-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 1rem;
            color: #9ca3af;
        }

        .upload-text {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .upload-subtext {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 1rem;
        }

        .btn {
            background-color: #2563eb;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn:hover {
            background-color: #1d4ed8;
        }

        .btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }

        .btn-outline {
            background-color: transparent;
            color: #2563eb;
            border: 1px solid #2563eb;
        }

        .btn-outline:hover {
            background-color: #eff6ff;
        }

        /* URL input */
        .url-container {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border-radius: 0.5rem;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .url-form {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .url-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
        }

        .url-input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
        }

        .url-list {
            margin-top: 1rem;
        }

        .url-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background-color: #f3f4f6;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
        }

        .url-item-text {
            word-break: break-all;
            flex: 1;
        }

        .url-item-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* PDF list and viewer */
        .pdf-container {
            margin-bottom: 2rem;
        }

        .pdf-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .pdf-tabs {
            display: flex;
            overflow-x: auto;
            gap: 0.5rem;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .pdf-tab {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            background-color: #f3f4f6;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            white-space: nowrap;
        }

        .pdf-tab.active {
            background-color: #2563eb;
            color: white;
        }

        .remove-btn {
            background: none;
            border: none;
            cursor: pointer;
            margin-left: 0.5rem;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-btn:hover {
            color: #ef4444;
        }

        .pdf-viewer {
            width: 100%;
            height: 500px;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
        }

        /* Chat section */
        .chat-container {
            margin-bottom: 2rem;
        }

        .message {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .message-user {
            background-color: #eff6ff;
        }

        .message-ai {
            background-color: #f3f4f6;
        }

        .message-header {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .message-attachments {
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: #6b7280;
        }

        /* Input form */
        .input-form {
            position: sticky;
            bottom: 1rem;
            background-color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: flex;
            gap: 0.5rem;
        }

        .input-field {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
        }

        .input-field:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
        }

        .input-hint {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
        }

        .hidden {
            display: none;
        }

        /* Loading indicator */
        .loading {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Tabs for input type */
        .input-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .input-tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-weight: 500;
        }

        .input-tab.active {
            border-bottom-color: #2563eb;
            color: #2563eb;
        }

        .input-tab:hover:not(.active) {
            border-bottom-color: #d1d5db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Badge */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            background-color: #eff6ff;
            color: #2563eb;
            margin-right: 0.5rem;
        }

        .badge-count {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 9999px;
            background-color: #2563eb;
            color: white;
            font-size: 0.75rem;
            margin-left: 0.25rem;
        }

        /* Source list */
        .source-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .source-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 0.75rem;
            background-color: #f3f4f6;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }

        .source-icon {
            margin-right: 0.5rem;
            width: 16px;
            height: 16px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>PDF & URL Chat Assistant</h1>

        <!-- Input Type Tabs -->
        <div class="input-tabs">
            <div class="input-tab active" data-tab="pdf-tab">PDF Upload</div>
            <div class="input-tab" data-tab="url-tab">URL Input</div>
            <div class="input-tab" data-tab="both-tab">Both</div>
        </div>

        <!-- PDF Upload Tab -->
        <div id="pdf-tab" class="tab-content active">
            <!-- PDF Upload Area -->
            <div id="uploadArea" class="upload-area">
                <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <p class="upload-text">Drag and drop your PDFs here</p>
                <p class="upload-subtext">or click to browse files</p>
                <button id="uploadBtn" class="btn">Upload PDFs</button>
                <input type="file" id="fileInput" accept="application/pdf" multiple class="hidden">
            </div>
        </div>

        <!-- URL Input Tab -->
        <div id="url-tab" class="tab-content">
            <div class="url-container">
                <h2>Enter URLs</h2>
                <form id="urlForm" class="url-form">
                    <input type="url" id="urlInput" class="url-input" placeholder="Enter a URL (webpage or PDF link)">
                    <button type="submit" class="btn">Add URL</button>
                </form>
                <div id="urlList" class="url-list"></div>
            </div>
        </div>

        <!-- Both Tab -->
        <div id="both-tab" class="tab-content">
            <!-- PDF Upload Area -->
            <div id="uploadAreaBoth" class="upload-area">
                <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <p class="upload-text">Drag and drop your PDFs here</p>
                <p class="upload-subtext">or click to browse files</p>
                <button id="uploadBtnBoth" class="btn">Upload PDFs</button>
                <input type="file" id="fileInputBoth" accept="application/pdf" multiple class="hidden">
            </div>

            <!-- URL Input -->
            <div class="url-container">
                <h2>Enter URLs</h2>
                <form id="urlFormBoth" class="url-form">
                    <input type="url" id="urlInputBoth" class="url-input"
                        placeholder="Enter a URL (webpage or PDF link)">
                    <button type="submit" class="btn">Add URL</button>
                </form>
                <div id="urlListBoth" class="url-list"></div>
            </div>
        </div>

        <!-- Source Summary -->
        <div id="sourceContainer" class="hidden" style="margin-bottom: 2rem;">
            <h2>Your Sources</h2>
            <div class="source-list" id="sourceList"></div>
        </div>

        <!-- PDF List and Viewer -->
        <div id="pdfContainer" class="pdf-container hidden">
            <div class="pdf-header">
                <h2>Uploaded PDFs</h2>
                <button id="addMoreBtn" class="btn btn-outline">Add More PDFs</button>
            </div>

            <div id="pdfTabs" class="pdf-tabs"></div>

            <iframe id="pdfViewer" class="pdf-viewer"></iframe>
        </div>

        <!-- Chat Messages -->
        <div id="chatContainer" class="chat-container hidden">
            <h2>Conversation</h2>
            <div id="messagesContainer"></div>
        </div>

        <!-- Input Form -->
        <form id="questionForm" class="input-form">
            <input type="text" id="questionInput" class="input-field"
                placeholder="Ask a question about your PDFs and URLs..." disabled>
            <button type="submit" id="submitBtn" class="btn" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </form>
        <p id="inputHint" class="input-hint">Add PDFs or URLs to start asking questions</p>
    </div>

    <script>
        // DOM Elemen
        const inputTabs = document.querySelectorAll('.input-tab');
        const tabContents = document.querySelectorAll('.tab-content');

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const uploadBtn = document.getElementById('uploadBtn');

        const uploadAreaBoth = document.getElementById('uploadAreaBoth');
        const fileInputBoth = document.getElementById('fileInputBoth');
        const uploadBtnBoth = document.getElementById('uploadBtnBoth');

        const urlForm = document.getElementById('urlForm');
        const urlInput = document.getElementById('urlInput');
        const urlList = document.getElementById('urlList');

        const urlFormBoth = document.getElementById('urlFormBoth');
        const urlInputBoth = document.getElementById('urlInputBoth');
        const urlListBoth = document.getElementById('urlListBoth');

        const sourceContainer = document.getElementById('sourceContainer');
        const sourceList = document.getElementById('sourceList');

        const addMoreBtn = document.getElementById('addMoreBtn');
        const pdfContainer = document.getElementById('pdfContainer');
        const pdfTabs = document.getElementById('pdfTabs');
        const pdfViewer = document.getElementById('pdfViewer');

        const chatContainer = document.getElementById('chatContainer');
        const messagesContainer = document.getElementById('messagesContainer');

        const questionForm = document.getElementById('questionForm');
        const questionInput = document.getElementById('questionInput');
        const submitBtn = document.getElementById('submitBtn');
        const inputHint = document.getElementById('inputHint');

        // State
        let pdfs = [];
        let urls = [];
        let activePdf = null;
        let isLoading = false;

        // Event Listeners for Tabs
        inputTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and contents
                inputTabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));

                // Add active class to clicked tab and corresponding content
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Event Listeners for PDF Upload
        uploadBtn.addEventListener('click', () => fileInput.click());
        uploadBtnBoth.addEventListener('click', () => fileInputBoth.click());
        addMoreBtn.addEventListener('click', () => {
            // Determine which file input to use based on active tab
            const activeTab = document.querySelector('.input-tab.active').getAttribute('data-tab');
            if (activeTab === 'pdf-tab') {
                fileInput.click();
            } else if (activeTab === 'both-tab') {
                fileInputBoth.click();
            }
        });

        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', handleDragOver);
        uploadArea.addEventListener('drop', handleDrop);

        uploadAreaBoth.addEventListener('click', () => fileInputBoth.click());
        uploadAreaBoth.addEventListener('dragover', handleDragOver);
        uploadAreaBoth.addEventListener('drop', handleDrop);

        fileInput.addEventListener('change', handleFileChange);
        fileInputBoth.addEventListener('change', handleFileChange);

        // Event Listeners for URL Input
        urlForm.addEventListener('submit', handleUrlSubmit);
        urlFormBoth.addEventListener('submit', handleUrlSubmit);

        // Event Listener for Question Form
        questionForm.addEventListener('submit', handleSubmit);

        // Functions for Tabs
        function setActiveTab(tabId) {
            inputTabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            tabContents.forEach(content => {
                if (content.id === tabId) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        // Functions for PDF Upload
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.style.backgroundColor = '#f3f4f6';
        }

        function handleDragLeave(e) {
            e.currentTarget.style.backgroundColor = '';
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.style.backgroundColor = '';

            if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
                const newFiles = Array.from(e.dataTransfer.files).filter(
                    file => file.type === 'application/pdf'
                );

                if (newFiles.length > 0) {
                    addPdfs(newFiles);
                }
            }
        }

        function handleFileChange(e) {
            if (e.target.files && e.target.files.length > 0) {
                const newFiles = Array.from(e.target.files).filter(
                    file => file.type === 'application/pdf'
                );

                if (newFiles.length > 0) {
                    addPdfs(newFiles);
                }
            }
        }

        function addPdfs(newFiles) {
            pdfs = [...pdfs, ...newFiles];
            updateUI();
            updateSourceList();

            if (!activePdf && pdfs.length > 0) {
                setActivePdf(pdfs[0]);
            }
        }

        // Functions for URL Input
        function handleUrlSubmit(e) {
            e.preventDefault();

            // Determine which input to use based on the form that was submitted
            const input = e.target === urlForm ? urlInput : urlInputBoth;

            const url = input.value.trim();
            if (url && isValidUrl(url)) {
                addUrl(url);
                input.value = '';
            } else {
                alert('Please enter a valid URL');
            }
        }

        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        function addUrl(url) {
            if (!urls.includes(url)) {
                urls.push(url);
                updateUI();
                updateSourceList();
                renderUrlLists();
            }
        }

        function removeUrl(url) {
            urls = urls.filter(u => u !== url);
            updateUI();
            updateSourceList();
            renderUrlLists();
        }

        function renderUrlLists() {
            // Clear both URL lists
            urlList.innerHTML = '';
            urlListBoth.innerHTML = '';

            // Render URLs in both lists
            urls.forEach(url => {
                const urlItem = createUrlItem(url);
                const urlItemClone = urlItem.cloneNode(true);

                // Add event listener to the remove button in both lists
                urlItem.querySelector('.remove-btn').addEventListener('click', () => removeUrl(url));
                urlItemClone.querySelector('.remove-btn').addEventListener('click', () => removeUrl(url));

                urlList.appendChild(urlItem);
                urlListBoth.appendChild(urlItemClone);
            });
        }

        function createUrlItem(url) {
            const urlItem = document.createElement('div');
            urlItem.className = 'url-item';

            const displayUrl = url.length > 50 ? url.substring(0, 50) + '...' : url;

            urlItem.innerHTML = `
                <span class="url-item-text" title="${url}">${displayUrl}</span>
                <div class="url-item-actions">
                    <button class="remove-btn" title="Remove URL">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            `;

            return urlItem;
        }

        // Functions for PDF Viewer
        function updateUI() {
            const hasContent = pdfs.length > 0 || urls.length > 0;

            if (pdfs.length > 0) {
                pdfContainer.classList.remove('hidden');
                renderPdfTabs();
            } else {
                pdfContainer.classList.add('hidden');
            }

            if (hasContent) {
                questionInput.disabled = false;
                submitBtn.disabled = false;
                inputHint.classList.add('hidden');
            } else {
                questionInput.disabled = true;
                submitBtn.disabled = true;
                inputHint.classList.remove('hidden');
                chatContainer.classList.add('hidden');
            }
        }

        function updateSourceList() {
            if (pdfs.length > 0 || urls.length > 0) {
                sourceContainer.classList.remove('hidden');
                renderSourceList();
            } else {
                sourceContainer.classList.add('hidden');
            }
        }

        function renderSourceList() {
            sourceList.innerHTML = '';

            if (pdfs.length > 0) {
                const pdfBadge = document.createElement('div');
                pdfBadge.className = 'source-item';
                pdfBadge.innerHTML = `
                    <svg class="source-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    PDFs <span class="badge-count">${pdfs.length}</span>
                `;
                sourceList.appendChild(pdfBadge);
            }

            if (urls.length > 0) {
                const urlBadge = document.createElement('div');
                urlBadge.className = 'source-item';
                urlBadge.innerHTML = `
                    <svg class="source-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="2" y1="12" x2="22" y2="12"></line>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    URLs <span class="badge-count">${urls.length}</span>
                `;
                sourceList.appendChild(urlBadge);
            }
        }

        function renderPdfTabs() {
            pdfTabs.innerHTML = '';

            pdfs.forEach(pdf => {
                const tab = document.createElement('div');
                tab.className = `pdf-tab ${activePdf === pdf ? 'active' : ''}`;

                const name = pdf.name.length > 20 ? `${pdf.name.substring(0, 20)}...` : pdf.name;
                tab.innerHTML = `
                    <span>${name}</span>
                    <button class="remove-btn" data-name="${pdf.name}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                `;

                tab.addEventListener('click', (e) => {
                    if (!e.target.closest('.remove-btn')) {
                        setActivePdf(pdf);
                    }
                });

                pdfTabs.appendChild(tab);
            });

            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const name = btn.getAttribute('data-name');
                    if (name) {
                        removePdf(name);
                    }
                });
            });
        }

        function setActivePdf(pdf) {
            activePdf = pdf;
            renderPdfTabs();
            pdfViewer.src = URL.createObjectURL(pdf);
        }

        function removePdf(name) {
            const index = pdfs.findIndex(pdf => pdf.name === name);

            if (index !== -1) {
                pdfs.splice(index, 1);
            
                if (activePdf && activePdf.name === name) {
                    activePdf = pdfs.length > 0 ? pdfs[0] : null;
                }
            
                updateUI();
                updateSourceList();
            
                if (activePdf) {
                    setActivePdf(activePdf);
                }
            }
            }

            // Functions for Chat
            async function handleSubmit(e) {
                e.preventDefault();

                if ((pdfs.length === 0 && urls.length === 0) || !questionInput.value.trim() || isLoading) {
                    return;
                }

                const question = questionInput.value.trim();

                // Create a message with attachments info
                const attachments = {
                    pdfs: pdfs.map(pdf => pdf.name),
                    urls: urls
                };

                addMessage('user', question, attachments);

                questionInput.value = '';
                isLoading = true;
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<div class="loading"></div>';
                questionInput.disabled = true;

                try {
                    // This is a placeholder for the actual API call
                    // In a real application, you would send the PDFs, URLs, and question to your backend

                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 2000));

                    // Simulate AI response
                    const response = `This is a simulated response to your question about the ${pdfs.length > 0 ? 'PDFs' : ''}${pdfs.length > 0 && urls.length > 0 ? ' and ' : ''}${urls.length > 0 ? 'URLs' : ''} you provided.
                
In a real application, you would send the ${pdfs.length > 0 ? 'PDFs' : ''}${pdfs.length > 0 && urls.length > 0 ? ' and ' : ''}${urls.length > 0 ? 'URLs' : ''} to a backend service that uses an AI model like Claude from Anthropic that can process both PDFs and web content.

The backend would:
1. Process the uploaded PDFs
2. Fetch and process the content from the provided URLs
3. Send all this information along with your question to the AI model
4. Return the AI's response

To implement this fully, you would need:
- A server backend (Node.js, Python, etc.)
- An API key for an AI service that supports PDF and URL processing
- Proper file handling and API integration`;

                    addMessage('ai', response);
                } catch (error) {
                    console.error('Error:', error);
                    addMessage('ai', 'Sorry, there was an error processing your request. Please try again.');
                } finally {
                    isLoading = false;
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                `;
                    questionInput.disabled = false;
                }
            }

            function addMessage(role, content, attachments = null) {
                chatContainer.classList.remove('hidden');

                const messageDiv = document.createElement('div');
                messageDiv.className = `message message-${role}`;

                let messageContent = `
                <div class="message-header">${role === 'user' ? 'You' : 'AI Assistant'}:</div>
                <div>${content.replace(/\n/g, '<br>')}</div>
            `;

                if (role === 'user' && attachments) {
                    let attachmentText = [];

                    if (attachments.pdfs && attachments.pdfs.length > 0) {
                        attachmentText.push(`${attachments.pdfs.length} PDF${attachments.pdfs.length > 1 ? 's' : ''}`);
                    }

                    if (attachments.urls && attachments.urls.length > 0) {
                        attachmentText.push(`${attachments.urls.length} URL${attachments.urls.length > 1 ? 's' : ''}`);
                    }

                    if (attachmentText.length > 0) {
                        messageContent += `
                        <div class="message-attachments">
                            ${attachmentText.join(' and ')} attached
                        </div>
                    `;
                    }
                }

                messageDiv.innerHTML = messageContent;
                messagesContainer.appendChild(messageDiv);

                // Scroll to bottom
                window.scrollTo(0, document.body.scrollHeight);
            }

            // Initialize
            updateUI();
            updateSourceList();
    </script>
</body>

</html>